\chapter{\textit{Bottom-Left}}\label{ch:bottom-left}
% TODO: adicionar figura com exemplo

Como descrito na \autoref{sec:classificacao}, a maioria das classes do problema são NP-difíceis.
Isso torna métodos de soluções exatos, os quais buscam pela solução ótima, extremamente custosos em tempo e recursos computacionais em instâncias de porte moderado, muitas vezes sendo inviável por falta de algum desses dois motivos.
Consequentemente a literatura é dominada por abordagens que usem heurísticas e meta-heurísticas, sendo a \textit{bottom-left} uma das principais estratégias de solução e será usada no estudo deste trabalho.

\input{utils/figures/bottom_left}

Sua premissa é simples, dado uma fila como entrada, enquanto ela não estiver vazia, basta retirar o primeiro item dela e alocar no canto mais a baixo e a esquerda quanto for possível\cite{aprendizado-reforco}, sem sobreposições entre peças (\autoref{sec:definicao}).
Caso não exista uma posição válida, a peça é desconsiderada e passa-se para próxima da fila.
A \autoref{fig:bottom-left} mostra um exemplo de alocação para um dado conjunto de peças regulares.

Vale destacar que a própria ordem da fila pode gerar resultados diferentes, alterando a qualidade da solução.
Um dos resultados esperados deste trabalho é comparar diferentes formas de ordenação e identificar se há alguma que se destaque na qualidade de solução, para isso será usado um conjunto de instâncias.


\section{Critérios de ordenação}\label{sec:criterios-de-ordenacao}

Para determinar o impacto da ordenação da fila, cinco critérios de ordenação
foram escolhidos, sendo eles: área, perímetro, largura, altura e \textit{id}.
A ordenação por \textit{id} considera a ordem em que os itens foram colocados na lista, ou seja,
seria a forma padrão de resolver e ele será a base para definir se os demais critérios possuem
algum benefício.
Além disso, cada critério pode ser usado para ordenar a fila em ordem crescente ou decrescente,
algo que também será analisado.


\section{Sobreposição e domínio infinito}\label{sec:sobreposicao-e-dominio-infinito}
% TODO: talvez trocar para domínio contínuo

Por mais simples que a heurística \textit{bottom-left} seja, ainda existem duas complicações,
respeitar a \Cref{eq:2} sobre sobreposição de peças e o domínio infinito de coordenadas
ao tentar alocar um item.
As \Crefrange{fig:sobreposicao-dominio}{fig:sobreposicao-dominio5} serão usadas para
demonstrar as complicações citadas.

A \Cref{fig:sobreposicao-dominio} mostra o estado de um modelo onde o item 0 foi o primeiro alocado
e o item 1 foi alocado a sua direita na posição (2, 0) para respeitar a \Cref{eq:1},
porque não cabia logo acima na posição (0, 2).


\input{utils/figures/sobreposicao-dominio/continuous_example}

Supondo que a próxima peça da fila tenha largura 3 e altura 1, ao posicioná-la na posição (0, 2)
percebe-se que a \Cref{eq:1} é satisfeita, mas a \Cref{eq:2} não (\Cref{fig:sobreposicao-dominio2}).

\input{utils/figures/sobreposicao-dominio/continuous_example2}

Nesse caso, com poucas peças alocadas e auxílio visual, é fácil identificar que a posição correta,
seguindo a lógica \textit{bottom-left}, seria a de coordenadas (0, 4)
(\Cref{fig:sobreposicao-dominio3}).
Porém, encontrar tal posição pode ser extremamente complexo.
Entre as coordenadas (0, 2) e (0, 4) o espaço é contínuo, existindo infinitas outras coordenadas
entre elas, sendo impossível checar todas.

\input{utils/figures/sobreposicao-dominio/continuous_example3}

Como todas as instâncias usadas para testes tratam somente de peças e recipientes com valores
inteiros, uma abordagem possível seria discretizar o domínio, conforme a
\Cref{fig:sobreposicao-dominio4}.

\input{utils/figures/sobreposicao-dominio/discrete_example}

Dessa forma somente coordenadas de valores inteiros precisariam ser verificadas, resolvendo
parcialmente o problema com domínio, já que ainda existiriam muitos pontos, principalmente em
instâncias com espaços grandes.
Mas isso ainda não resolve a parte de sobreposição.
Para cada ponto ainda é necessário verificar se existe sobreposição com cada uma das peças já
alocadas, algo extremamente custoso.

Na \Cref{fig:sobreposicao-dominio5} é possível notar que três coordenadas precisaram ser checadas
até encontrar uma que cumprisse as \Cref{eq:1,eq:2}.
Por se tratar de um estado inicial de um modelo pequeno esse processo não é tão custoso, porém em
modelos maiores ou estados mais avançados isso se tornará cada vez mais custoso, visto que o domínio
será maior e, principalmente, mais peças estarão alocadas para checar possíveis sobreposições.

\input{utils/figures/sobreposicao-dominio/discrete_example2}

Outro fator o qual deve ser observado é de que a discretização do domínio pode não funcionar bem em
casos onde os valores trabalhados não sejam inteiros.
Nesses casos a discretização poderia ocorrer com algum nível de precisão nas casas decimais,
mas ainda assim as chances de desperdício de área são grandes.
Ou seja, muitos problemas reais seriam complexos de serem resolvidos com a discretização.


\section{Criação de regiões}\label{sec:criacao-de-regioes}
% TODO: talvez dar nomes para soluções com e sem região

Os dois problemas expostos na \Cref{sec:sobreposicao-e-dominio-infinito} podem ser facilmente
resolvidos utilizando a estratégia de criação de regiões.
Com essa técnica é possível ignorar a \Cref{eq:2}.
Nela, ao posicionar uma peça, duas regiões são criadas (\Cref{fig:regiao-vertical}) e o item
seguinte será somente posicionado se couber em uma das regiões disponíveis.

\input{utils/figures/regioes/regiao_vertical}

Agora o domínio passa a ser somente o canto inferior esquerdo de cada uma das regiões e
sobreposições deixam de ser possíveis.
Além disso, a regra para definir se uma peça cabe em dada região é igual a \Cref{eq:1}, tornando
o algoritmo de solução bem simples.
A fim de identificar o impacto das regiões na solução do modelo, quatro formas de criação
delas foram usadas.

A primeira delas é \textbf{traçando uma linha vertical} a partir do canto superior direito de cada
peça alocada (\Cref{fig:regiao-vertical}).
A segunda é igual a primeira, porém \textbf{traçando uma linha horizontal} (\Cref{fig:regiao-horizontal}).

\input{utils/figures/regioes/regiao_horizontal}

Já na terceira, a linha traçada (vertical ou horizontal) depende da área das regiões criadas
com cada linha.
Nesse modo o objetivo é maximizar a área de uma das regiões geradas, ele identifica qual linha
irá gerar a região de maior área e a traça.
Por exemplo, a \Cref{fig:regiao-vertical} gerou uma região com 252 de área e outra com 1320,
enquanto a \Cref{fig:regiao-horizontal} obteve regiões com 1440 e 132, então, nesse caso, a linha
traçada será a horizontal (\Cref{fig:regiao-max}).

\input{utils/figures/regioes/regiao_max}

Maximizar uma região pode ser interessante, pois aumenta as chances do próximo item conseguir ser
alocado, visto que uma das regiões será mais espaçosa.
Em contrapartida, esse método também pode acabar gerando muitas regiões pequenas que não sejam
utilizadas, diminuindo a qualidade da solução.

No quarto e último modo de criar regiões nenhuma linha é traçada, todas as regiões vão até o final
do recipiente (\Cref{fig:regiao-none}).
Nesse caso, sobreposições de peças podem ocorrer, então verificações são necessária para cumprir
a \Cref{eq:2}.
Ao fazer isso, possibilita que mais peças sejam alocadas, visto que todas as regiões possuem área
máxima.
Esse modo foi criado para identificar se é de fato melhor que os demais e qual seu custo.

\input{utils/figures/regioes/regiao_none}

Com os critérios para criação de regiões explicados, é possível diferenciá-los em dois tipos.
O primeiro é dos que permitem sobreposição entre peças e, por isso, precisam de verificações para
respeitar a \Cref{eq:2}, nesse tipo se encaixa somente o quarto modo.
O segundo tipo contém os três primeiros critérios, onde somente a \Cref{eq:1} precisa ser checada.